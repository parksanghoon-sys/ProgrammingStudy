# 웹서비스의 지도

---

## 웹서비스 창시

웹서비스의 창시자는 논문의 첨부된 논문을 확인하고싶어 HTML 을 만들게 되었으며, 논문끼리의 Link 가 이루어 지게 되었으며, 또한 내/외부의 HTTP를 개발하여 HTML 안에서의 이동이 가능하도록 하였다.

URL : Host + IP 의 구조이며 이를 이용하여 HTML 을 요청하고 받는 구조의 TCP의 통신이 이루어 지게된다

---

## 웹서비스의 구조

HTML + HTTP 로 Web은 이루어져 있다. 문서끼리의 Link 로 웹서비스가 되었다.

웹서비스를 이용하는 Client가 있고 Service를 제공해주는 Web Server가 존재하게 된다. L2 와 라우터를 이용하여 HTTP 토연결되어 있다.

Browser는 원격지 문서 뷰어라고 볼 수 있다.

### 클라이언트 서버 HTTP 요청 순서

1. 서버는 접속대기상태이다
2. 필요시에 클라이언트는 URL을 통해 서버와 TCP 연결 한다.
3. 클라이어트는  HTTP Request를  진행하여 HTML 문서를 송신을 요청한다
   1. GET : 문서정보 경로요청
4. 서버는 HTTP Response를 하여 HTML  + CSS + 사진 + JS를 전송한다.
5. 클라이언트는 HTML 화면을 보여준다
   1. 수신받은 HTML Tag 구문을 분석한다.
   2. CSS를 이용하여 화면에 렌더링이 진행된다
   3. V8 엔진같은 자바스크립트 엔진이 필요한다.

### 정적요소

HTTP 요청시에 전송되는 정적요소는 아래와 같다

* CSS
  * HTML 문서를 꾸미기 위해 태어나게되었다.
* 사진
* HTML

### Netscape

움직임이 필요하게 되어 Script 즉 Java script가 탄생하게 되었다.

---

## SW 설계원칙

아래 3개를 분리하여 관리하자 그래야 유지보수가 편해지게된다

* UI
* Logic
* Data

---

## WAS와 REST API

기존 단방향 에서 양방향 상호작용으로 변경이 된다.

단순 문서만 표출이 아니라 라이브방송 처럼 양방향의 상호작용이 필요해 지는데, 문제가 발생하게 된다. 절차, 상태 전이 가 발생하게 된다.

예를 들면 로그인을 들면 아이디 비밀번호를 서버에 전달해야하는데 이런정보를 넘길때는 POST로 가게 된다. 이때 Server 관점에서는 원격자 사용자 입력으로 볼수 있다, 이럴경우 서버에서 파라미터에대한 절차 및 처리 즉 함수(서비스)가 필요해지는데 클라이언트오 서버 모두 로직이 존재하고 그 로직은 CGI 로 개발이 되고 실행코드를 실행시키게 되었다. 그로인해 플랫폼 종속성 C언어로 초기에 개발이 되었지만 추후 플랫폼에 상관없는 언어 즉 OS 상관이 없는 JAVA 로 구성하게 된다.

컴퓨터는 3가지로 구성이 된다 HW / Kunel 모드/ User모드로 구성이된다.

### WAS(Web Application Server)

웹어플리케이션 서버 라고한다. 데이터 처리를 전문으로 하게 된다. 현재 우리나라는 주로 JAVA로 구성되어 있다

WAS 데이터처리구조

1. 클라이언트 파라미터 데이터와 함께 요청이들어온다
2. 웹서버가 해당 정보를 WAS 로 데이터를 전송한다.
3. WAS 가 파라미터 데이터를 이용하여 문서를 만든다. (컴퓨터 내부에서 HTML 문서가 아니라 동적으로 생성하기 떄문에 **동적문서**라고한다)
4. 클라이언트에게 전달한다.

이러한 데이터를 저장하기 위해 DataBase 가 필요해진다.

클라이언트는 이러한 데이터를 저장하기위해 **Cookie**를 이용한다.

#### Cookie란?

Key = value 형태로 구성이 되어있다.

File로도 저장이 가능하고 범위 + 기간 등 설정이 된다.

---

위의 과정의 로그인 등의 웹 클라이언트, 서버 , WAS, DB 등의 양방향 상호작용을 위해서 **Session**이 시작되었다.

위 서비스가 필요한 이유는 HTTP가 상태 비저장 통신이기 때문이다.

JAVA는 JavaVirtuialMachin 이 존재하는데 Java byte code를 작동하게 된다. 소스파일을 빌드하면 .class파일이되고 이 단위모듈이 모여서 java byte code로 컴파일이되고 작동하게된다.

---

웹서버 진행순서

1. 클라이언트는 HTTP 요청을 보낸다 (Creat, Read, Update, Delete)
2. WAS 에게 전달이 된다.
3. WAS는 DB를 조회하고 HTML 파일을 만들어 서버로 전송한다
4. 서버는 요청에 대한 HTTP 응답을 보낸다.

이러한 HTTP 요청 CRUD가 DB에 서비스를 유발하여 REST API가 나왔다.

HTML은 각 장치의 의존성이 있었는데 예를 들면 화면의 크기 및 비율이 모두 달라지게 된는데 이러한 거에 맞춰 장치에 맞춰 WAS에서 조치를 각기 다르게 해야해서 HTML을 보내는 형테에서 DATA만 전송하도록 변경이 되었다 예를들면 JSON, XML 형태로 이제 그럼 클라이언트가 해당 데이터를 받아서 JS를 이요해 HTML을 작성하도록 하게된다 그게 React 및 Vue 등 프레임워크가 존재하게 되었다.

이렇게 결국 서버는 WebServer + WAS + DB 이렇게 3개의 3-Tier 형태로 구성되어 진다. 

데이터베이스 및 was jav 등의 성능 모니터링하는 **APM Scouter**가 있는데 확인해 보길한댄다.

---

## 보안

원격지 사용자 입력에 대해 신뢰를 하면안된다, 검증을 항상 필수로 하여야한다.

입력에 JS를 작성하고 스크립트 게시물이 개발하지 않은게 동작하게 하도록 하는게 XSS라고한다.

입력에 SQL문 넣으면 SQL Injection

입력에 OS 명령을 넣으면 OS Command Injection

HTTP 통신은 평문이기에  + SSL 조합되어 HTTPS 형태로 오게된다

* IPS
  * 1번쨰 보안 장치
* SSL
  * HTTPS 암호를 해재한다
  * PKI 기술이 적용이 되어있다. 해당 이론은 아는것이 좋다
* WAF (Web App Fall) 웹방화벽
  * 웹어플리케이션 방화벽
  * HTTP 평문이 되어 조사한다

**CORS**

클라이언트 입장에서 웹서버에서 받은 리소스를 확인하고 이에대해 출처에대해 허용을 해줄지 아닐지 하는것
