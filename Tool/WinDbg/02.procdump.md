
좋아요 👍 C# 개발자 기준으로 설명드릴게요.

**ProcDump**는 Microsoft의 **Sysinternals** 도구 중 하나로, **프로세스의 메모리 덤프(.dmp)** 파일을 생성하는 유틸리티입니다.

이 덤프 파일은 Visual Studio나 WinDbg 등에서 분석하여 **비정상 종료, 예외, CPU Hang, 메모리 누수** 등을 추적할 수 있습니다.

---

## 🧰 1. 다운로드 및 준비

* 공식 링크:

  🔗 [https://learn.microsoft.com/en-us/sysinternals/downloads/procdump](https://learn.microsoft.com/en-us/sysinternals/downloads/procdump)
* 파일 압축을 풀고 예를 들어 `C:\Tools\Procdump\procdump.exe` 위치에 둡니다.

---

## ⚙️ 2. 기본 명령어 형식

```cmd
procdump [옵션] <프로세스명 또는 PID> [덤프파일경로]
```

### 예시

```cmd
procdump -ma notepad.exe C:\Dump\notepad.dmp
```

→ `notepad.exe`의  **전체 메모리 덤프** (`-ma`)를 `C:\Dump` 폴더에 저장합니다.

---

## 🧩 3. 주요 옵션 정리

| 옵션                | 설명                                            |
| ------------------- | ----------------------------------------------- |
| `-ma`             | 전체 메모리 덤프 (Full Dump) 생성               |
| `-mp`             | 최소 덤프 (Mini Dump) 생성 (메모리 일부만 포함) |
| `-e`              | 예외 발생 시 자동 덤프 생성                     |
| `-t`              | 종료 시점 덤프 생성                             |
| `-c <CPU%>`       | 지정한 CPU 사용률 초과 시 덤프 생성             |
| `-h`              | Hang (응답 없음 상태) 감지 시 덤프 생성         |
| `-n <count>`      | 지정 횟수만큼 덤프 생성                         |
| `-s <seconds>`    | 지정 시간 간격으로 덤프 반복 저장               |
| `-w <프로세스명>` | 특정 프로세스가 시작될 때까지 대기 후 덤프 생성 |
| `-accepteula`     | EULA 자동 수락 (자동화 스크립트 시 유용)        |
| `-f <에러메시지>`     | 특정 에러 메시지나 문자열을 필터링              |

---

## 💣 4. 자주 쓰는 패턴별 예시

### 🔹 (1) 즉시 전체 덤프

```cmd
procdump -ma 1234 C:\Dump\app_full.dmp
```

→ PID 1234 프로세스의 전체 메모리 덤프.

---

### 🔹 (2) 예외 발생 시 자동 덤프

```cmd
procdump -e -ma FlightImageDisplay.exe C:\Dump
```

→ FlightImageDisplay.exe에서 **Unhandled Exception** 발생 시 자동으로 덤프를 저장.

---

### 🔹 (3) 비정상 종료 시 덤프 (프로세스 크래시 감시)

```cmd
procdump -ma -t myapp.exe C:\Dump
```

→ 프로세스가 **Crash 시 자동으로 덤프** 생성.

---

### 🔹 (4) CPU 90% 이상 시 덤프

```cmd
procdump -c 90 -ma myapp.exe C:\Dump
```

→ myapp.exe의 CPU 사용률이 90%를 초과하면 덤프 생성.

---

### 🔹 (5) 프로세스 시작 시 덤프

```cmd
procdump -w myapp.exe -ma C:\Dump
```

→ `myapp.exe`가 실행될 때 자동으로 덤프 생성.

---

## 🧠 5. Visual Studio에서 분석

1. Visual Studio → **File → Open → File → `.dmp` 파일 선택**
2. 자동으로 **Call Stack / Threads / Modules / Exception 정보** 확인 가능

   (단, `PDB` 심볼 파일이 필요하면 Symbol Server 설정 필요)

---

## ⚡ 6. 자동화 팁 (예: 크래시 자동 수집 스크립트)

```cmd
@echo off
set PROC_NAME=MyApp.exe
set DUMP_DIR=C:\Dump
mkdir %DUMP_DIR%
procdump -e -t -ma %PROC_NAME% %DUMP_DIR% -accepteula
```

→ 예외나 종료 시점에 자동 덤프 수집 후 로그 보관.

---

## 🧾 7. 참고: 덤프 크기

* **MiniDump (`-mp`)** : 수십 MB 수준
* **FullDump (`-ma`)** : 수백 MB~수 GB 가능

  (힙, 스택, 핸들, 모듈 등 모두 포함되므로 공간 확보 필요)

---

## ✅ 요약

| 상황                       | 명령어                                   |
| -------------------------- | ---------------------------------------- |
| 전체 메모리 덤프           | `procdump -ma <pid> C:\Dump\app.dmp`   |
| 예외 발생 시 덤프          | `procdump -e -ma <프로세스명> C:\Dump` |
| CPU Hang 시 덤프           | `procdump -h -ma <프로세스명> C:\Dump` |
| 프로세스 종료 시 덤프      | `procdump -t -ma <프로세스명> C:\Dump` |
| 프로세스 시작 시 자동 감시 | `procdump -w <프로세스명> -ma C:\Dump` |

---

원하신다면,

“ **예외 발생 시 자동으로 덤프 남기고, Visual Studio에서 자동으로 열기** ”

까지 포함한 **PowerShell 자동화 스크립트**도 만들어드릴까요?
