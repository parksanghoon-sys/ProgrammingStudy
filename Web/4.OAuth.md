# OAuth

## OAuth 란

다양항 플랫폼 환경에서 권한 부여를 위한 산업 표준 프로토콜이다. 간단하게 인증과 권환을 획득하는 것이다.

* Authentication(인증)
  * 시스템의 접근을 확인하는것 (로그인)
  * 인증만 하는 경우 는 OpenID
* Authorization(권한)
  * 행위의 권리를 검증하는 것

OAuth는 인터넷 사용자들이 비밀번호를 제공하지 않고 다른 웹사이트 상의 자신의 정보에 대해 어플리케이션의 접근 권한을 부여하는 공통적인 수다느로 새용되는 접근 위임을 위한 개방적 표준이다.

## OAuth2 의 4가지 역할

* Client(앱)
  * 앱이 사용자 데이터에 접근할 권한을 요청 시 OAuth2의 절차적 흐름이 시작되고 앱이 사용자의 데이터를 받는다.
* 데이터 제공기관(Resource Server)
  * 사용자의 데이터를 보유하고 유효한 접근 권한을 부여받은 앱이 요청 시 사용자 데이터를 제공하기도 하는 서버를 의미한다, 경우에 따라 데이터 보유기관이라고 생각된다
  * 데이터제공기관은 앱이 접근 토큰을 사용자 데이터와 교환할 수 있는 API를 제공하는 기관이다.
* 권한 제공기관(Authorization Server)
  * 사용자 데이터에 접근권한을 제공하는 서버이다
  * 앱의 접근 요청에 따라 사용자에게 앱에대해 등록된 정보 및 앱이 요청한 데이터 항목, 활용하려는 목적 및 기간에 대한 정보를 제시하고 사용자의 동의 여부를 문의하는 역할을 한다
  * 소규모 시스템의 경우 하나의 개체가 권한 제공 기관과 데이터 제공기관의 2가지 역할을 수행하는 경우도 있으나, 규모가 클수록 권한 제공기관과 데이터 제공기관을 분리하새 구현한다.
* 사용자 (Resouce Owner)
  * 사용자는 OAuth2의 최고 권력자이다
  * 사용자는 임의로 자신의 데이터에 대한 접근 권한을 부여, 거부, 또는 철회할수 있는 주체이다.

### 인가 승인

인가승인은 클라이언트가 접근 토큰을 얻기 위해 사용되는 것으로 리소스 소유자의 인가를 나타내는 자격증명이다, 이 면세는 네가지 승인코드(인가코드, 암시적 승인, 리소스 소유자 패스워드 자격증명, 클라이언트 자격증명)과 추가적인 유형정의를 위한 확장 메커니즘을 정의한다.

## OAuth 매커니즘

### OAuth2 의토 큰

OAuth2가 지원하는 여러가지 권한 부여방시그이 공통점은 토큰을 사용한다는 것이다.

토큰의 종류로 접근토큰과 재생 토큰이 있다.

OAuth2에선의 접근토큰 및 재생토큰이 가져야할 특정항 형식을 지정하고 있지 않다, 개발자가 임의로 토큰을 구현할수 있도록 설계되어있다,

* 접근코큰(Access Token)
  * 사용자의 데이터에 접근하기 위해 필요한 자격증명으로 사용자가 특정 앱에게 부여한 권한에 대한 정보가 담긴 문자열이다.
  * 접근할수 있는 특정 scope들과 접근 가능한 기간등 사용자가 동의한 사항에 대해 정보가 있다.
  * 이정보에 기방하여 권한제공 기관 및 데이터 제공기관은 앱의 요청에 응한다,
* 재상토큰 (Refresh Token)
  * 누근든 유효한 접근 토큰을 보유 시 통제된 데이터에 접근이 가능하다
  * 접근토큰이 노출될 리스크를 감안해 피해를 최소화 하기위해 토큰의 유효시간을 짧게 설정한다.
  * 접근토큰의 유효기간이 만료 시 앱개발자는 재생토큰을 사요할수 있다. 이로써 사용자에게 인증을 반복하지 않고 접근 토큰을 새로 발급이 가능하다.

입력 예시

Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1laWQiOiJlMDdmM2M0NS01NTE2LTRkZTgtOWFkNC1jZTVjMTg5YzA0NDgiLCJlbWFpbCI6WyJhZG1pbkBpbWFnZXZpZXdlci5jb20iLCJhZG1pbkBpbWFnZXZpZXdlci5jb20iXSwidW5pcXVlX25hbWUiOiJhZG1pbkBpbWFnZXZpZXdlci5jb20iLCJyb2xlIjoiQWRtaW4iLCJzdWIiOiJlMDdmM2M0NS01NTE2LTRkZTgtOWFkNC1jZTVjMTg5YzA0NDgiLCJqdGkiOiIyMzJkZTM5Yi01ZDFjLTQyNmUtYTk5Ny1hN2I3MGMzYjc1MDkiLCJpYXQiOjE3NTgwNjcwODIsIm5iZiI6MTc1ODA2NzA4MiwiZXhwIjoxNzU4MDk1ODgxLCJpc3MiOiJJbWFnZVZpZXdlci5BdXRoU2VydmljZSIsImF1ZCI6IkltYWdlVmlld2VyLkNsaWVudCJ9.phrOpXibbMR-maVOGtgvoKRr4CMzUdgwY0-eH_qHoao
